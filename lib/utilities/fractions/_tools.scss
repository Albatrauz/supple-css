/*  =========================================================================
    utilities.fractions.tools
    Functions and/or mixins used in this module
    ========================================================================= */

/*  Use rules
    `@use` everything you need here from other files. Variables, mixins &
    other includes.
    ========================================================================= */

/**
 * Forward supples generic tools to the parent stylesheet
 */
@forward '../../tools';


/**
 * Use the settings & tools in this sheet
 */
@use 'sass:math';
@use './variables';
@use '../../tools';



/*  Functions
    ========================================================================= */



/*  Mixins
    ========================================================================= */

/**
 * Fluid units
 * USAGE: provide a space-separated list of integers, each of which
 * represents the number of fractions that make up a unit component.
 * Optionally provide a modifier suffix that can be used to adjust
 * grids in different contexts (e.g. viewport dimensions).
 */

/* stylelint-disable max-nesting-depth */
@mixin build ($units, $modifier: '') {
  /**
   * Proportional fractions
   * Specify the proportional width of an object.
   * Primarily for, but not limited to, use with `.grid__cell` components.
   * Intentional redundancy build into each set of unit classes.
   */
  @each $denominator in $units {
    @for $numerator from 1 through $denominator {
      // Initialize variables
      $numerator-r: 0;
      $denominator-r: 0;

      // Find the greatest common factor
      $gcf: tools.functions-greatest-common-factor($numerator, $denominator);

      @if $gcf > 1 {
        // Reduced value of $numerator
        $numerator-r: $numerator/$gcf;
        // Reduced value of $denominator
        $denominator-r: $denominator/$gcf;
      }

      // Check if the reduced value of $denominator-r was also supplied in the
      // list of units to be built
      $canreduce: tools.functions-list-contains($units, $denominator-r);

      /**
       * Create units based on fractions
       * 1. Use `flex-basis: auto` with a width to avoid box-sizing bug in IE10/11
       */
      .u-fraction--#{$numerator}of#{$denominator}#{$modifier} {
        @if $canreduce {
          // stylelint-disable-next-line scss/at-extend-no-missing-placeholder
          @extend .u-fraction--#{$numerator-r}of#{$denominator-r}#{$modifier};
        } @else {
          flex-basis: auto !important; /* [1] */
          width: math.percentage($numerator / $denominator) !important;
        }
      }
    }
  }
}
/* stylelint-enable max-nesting-depth */
